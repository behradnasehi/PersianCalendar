EXEC sp_configure 'clr enabled' , '1' 
go 
reconfigure;

GO


CREATE ASSEMBLY PersianCalendar 
FROM 'f:\DatabaseBackups\nasehi\persian\bin\Debug\PersianCalendar.dll'

GO


CREATE FUNCTION [dbo].[ToPersianDateTime] (@dt [datetime])
RETURNS [nvarchar](MAX)
AS EXTERNAL NAME [PersianCalendar].[UserDefinedFunctions].[ToPersianDateTime];

GO

CREATE FUNCTION [dbo].[ToPersianDate] (@dt [datetime])
RETURNS [nvarchar](MAX)
AS EXTERNAL NAME [PersianCalendar].[UserDefinedFunctions].[ToPersianDate];

GO

CREATE FUNCTION [dbo].[IsLeapYear] (@sal [int])
RETURNS [bit]
AS EXTERNAL NAME [PersianCalendar].[UserDefinedFunctions].[IsLeapYear];

GO

CREATE FUNCTION [dbo].[DATEADDPersian] (@datepart [nvarchar](MAX), @number [int], @date [nvarchar](MAX))
RETURNS [nvarchar](MAX)
AS EXTERNAL NAME [PersianCalendar].[UserDefinedFunctions].[DATEADDPersian];

GO
CREATE FUNCTION [dbo].[DATEDIFFPersian] (@datepart [nvarchar](MAX), @date_from [nvarchar](MAX), @date_to [nvarchar](MAX))
RETURNS [int]
AS EXTERNAL NAME [PersianCalendar].[UserDefinedFunctions].[DATEDIFFPersian];

GO

CREATE FUNCTION [dbo].[ISDATEPersian] (@date [nvarchar](MAX))
RETURNS [bit]
AS EXTERNAL NAME [PersianCalendar].[UserDefinedFunctions].[ISDATEPersian];

GO


CREATE ASSEMBLY [PersianCalendar] AUTHORIZATION [dbo]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103003AF37F560000000000000000E00002210B010B00000A00000006000000000000EE280000002000000040000000000010002000000002000004000000000000000400000000000000008000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000942800005700000000400000C002000000000000000000000000000000000000006000000C0000005C2700001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000F408000000200000000A000000020000000000000000000000000000200000602E72737263000000C00200000040000000040000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001000000000000000000000000000004000004200000000000000000000000000000000D0280000000000004800000002000500342200002805000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001330050008010000010000110072010000700A1716FE01130900730500000A0B07026F0600000A0C07026F0700000A0D07026F0800000A130407026F0900000A130507026F0A00000A130607026F0B00000A13071F0B8D0C000001130A110A161202280C00000A1A1F306F0D00000AA2110A177203000070A2110A181203280C00000A181F306F0D00000AA2110A197203000070A2110A1A1204280C00000A181F306F0D00000AA2110A1B7207000070A2110A1C1205280C00000A181F306F0D00000AA2110A1D720B000070A2110A1E1206280C00000A181F306F0D00000AA2110A1F09720B000070A2110A1F0A1207280C00000A181F306F0D00000AA2110A280E00000A0A0006730F00000A13082B0011082A1330050096000000020000110072010000700A1716FE01130600730500000A0B07026F0600000A0C07026F0700000A0D07026F0800000A13041B8D0C00000113071107161202280C00000A1A1F306F0D00000AA21107177203000070A21107181203280C00000A181F306F0D00000AA21107197203000070A211071A1204280C00000A181F306F0D00000AA21107280E00000A0A0006730F00000A13052B0011052A000013300200180000000300001100730500000A0A06026F1000000A281100000A0B2B00072A1E02281200000A2A42534A4201000100000000000C00000076322E302E35303732370000000005006C000000D4010000237E0000400200002002000023537472696E6773000000006004000010000000235553007004000010000000234755494400000080040000A800000023426C6F620000000000000002000001471502000900000000FA253300160000010000000D000000020000000400000003000000120000000600000003000000010000000200000000000A00010000000000060043003C000A006B005600060075003C000A009E0056000600D400C1001700E800000006001701F70006003701F7000A00800165010600550195010600AA0195010600EE013C000600F5013C000000000001000000000001000100010010001E00000005000100010050200000000096007E000A000100642100000000960090000A0002000822000000009600A900110003002C22000000008618B4001700040000000100BA0000000100BA0000000100BD002900B4001B003900B40021004100B40017004900B40017005100B40017005900B3012B005900BB012B005900C4012B005900D2012B005900DA012B005900E4012B006900FB01310061000402350061000C023B001100B40041005900A9006500210013026A000900B40017002000230026002E001B0089002E000B0077002E001300800040002300260060002300260046005700700004800000000000000000000000000000000055010000020000000000000000000000010033000000000002000000000000000000000001004A00000000000000003C4D6F64756C653E005065727369616E43616C656E6461722E646C6C0055736572446566696E656446756E6374696F6E73006D73636F726C69620053797374656D004F626A6563740053797374656D2E446174610053797374656D2E446174612E53716C54797065730053716C537472696E67004461746554696D6500546F5065727369616E4461746554696D6500546F5065727369616E446174650053716C426F6F6C65616E0049734C65617059656172002E63746F720064740073616C0053797374656D2E446961676E6F73746963730044656275676761626C6541747472696275746500446562756767696E674D6F6465730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465005065727369616E43616C656E646172004D6963726F736F66742E53716C5365727665722E5365727665720053716C46756E6374696F6E4174747269627574650053797374656D2E476C6F62616C697A6174696F6E0043616C656E6461720047657459656172004765744D6F6E7468004765744461794F664D6F6E746800476574486F7572004765744D696E757465004765745365636F6E6400537472696E6700496E74333200546F537472696E67005061644C65667400436F6E636174006F705F496D706C696369740000000100032F000003200000033A000000D2ACE7DDF901F149916AAF34E05AD0580008B77A5C561934E0890600011109110D050001111108032000010520010111190420010108040100000005200108110D0320000E0520020E08030500010E1D0E042001010E10070B0E12290808080808081109021D0E0D07080E12290808081109021D0E0420010208050001111102060702122911110801000701000000000801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F777301000000003AF37F5600000000020000001C0100007827000078090000525344536DED9571E3F2704FBFCBCD9687E925AE03000000643A5C5065727369616E43616C656E6461725C5065727369616E43616C656E6461725C6F626A5C44656275675C5065727369616E43616C656E6461722E70646200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BC2800000000000000000000DE280000002000000000000000000000000000000000000000000000D02800000000000000000000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058400000640200000000000000000000640234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004C4010000010053007400720069006E006700460069006C00650049006E0066006F000000A001000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E003000000048001400010049006E007400650072006E0061006C004E0061006D00650000005000650072007300690061006E00430061006C0065006E006400610072002E0064006C006C0000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000005000140001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000005000650072007300690061006E00430061006C0065006E006400610072002E0064006C006C000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C000000F03800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = SAFE

GO

ALTER ASSEMBLY [PersianCalendar]
ADD FILE FROM 0x4D6963726F736F667420432F432B2B204D534620372E30300D0A1A445300000000020000020000001B00000088000000000000001900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020F9CFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF180230FCFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0BCA3101380000000010000000100000000000000D00FFFF04000000038000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA3101380000000010000000100000000000000E00FFFF0400000003800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F862513FC607D311905300C04FA302A1C4454B99E9E6D211903F00C04FA302A10B9D865A1166D311BD2A0000F80849BD60A66E40CF64824CB6F042D48172A79910000000000000008F2473CB31821EDE084167B84956AE9C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA310138000000001000000010000000000000FFFFFFFF040000000380000000000000FFFFFFFF00000000FFFFFFFF00000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA310138000000001000000010000000000000FFFFFFFF040000000380000000000000FFFFFFFF00000000FFFFFFFF00000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B601000000000000B60100000000000000000000000000000000000000000000D40600005C0200002C000000A0000000FFFFFFFF2800000018000000030000000600000016000000070000000A00000009000000040000000C0000000D0000000E0000000F000000100000001100000013000000120000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001BE2300180000000D07EFE6BB140D101020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000200000001000000020000000000000035000000280000001BE2300169D3A7E258000000010000003400000035000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FEEFFEEF010000006800000000643A5C5065727369616E43616C656E6461725C5065727369616E43616C656E6461725C417373656D626C79496E666F2E63730000643A5C7065727369616E63616C656E6461725C7065727369616E63616C656E6461725C617373656D626C79696E666F2E6373000400000001000000340000003500000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001BE2300180000000A4584078B140D101030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000200000001000000020000000000000035000000280000001BE2300169D3A7E258000000010000003400000035000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000003A002A11000000007C0200000000000008010000000000000000000001000006000000000100000000546F5065727369616E4461746554696D6500001600031104000000480200000801000000000000010000000A0024115553797374656D00120024115553797374656D2E44617461000000001A0024115553797374656D2E446174612E53716C436C69656E7400001A0024115553797374656D2E446174612E53716C54797065730000001E002411554D6963726F736F66742E53716C5365727665722E536572766572001A0024115553797374656D2E476C6F62616C697A6174696F6E0000001E002011080000000100001100000000000004004353243124303030300000001E002011090000000100001100000000000004004353243424303030310000001E0020110A0000000100001100000000000004004353243024303030320000001A00201100000000010000110000000000000000726573756C740000160003114000000044020000EE0000000D0000000100000026002011010000000100001100000000000000006F626A5065727369616E43616C656E64617200001A0020110200000001000011000000000000000079656172000000001A002011030000000100001100000000000000006D6F6E74680000001600201104000000010000110000000000000000646179001A00201105000000010000110000000000000000686F75720000000016002011060000000100001100000000000000006D696E0016002011070000000100001100000000000000007365630002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040000000C000000010006000200060036002A1100000000140400000000000096000000000000000000000002000006080100000100000000546F5065727369616E4461746500001600031180020000E00300009600000008010000010000001E002011050000000200001100000000000004004353243124303030300000001E002011060000000200001100000000000004004353243424303030310000001E002011070000000200001100000000000004004353243024303030320000001A00201100000000020000110000000000000000726573756C74000016000311B8020000DC0300007C000000150100000100000026002011010000000200001100000000000000006F626A5065727369616E43616C656E64617200001A0020110200000002000011000000000000000079656172000000001A002011030000000200001100000000000000006D6F6E746800000016002011040000000200001100000000000000006461790002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D004400320000000401000004012A020C000000010000060200060032002A1100000000D004000000000000180000000000000000000000030000069E010000010000000049734C656170596561720016000311180400009C040000180000009E010000010000001E0020110100000003000011000000000000040043532431243030303000000016002011000000000300001100000000000000006A630000020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D004400320000000401000004017E000C0000000100000602000600F2000000CC000000000000000100010008010000000000000F000000C0000000000000000C000080010000000D000080070000000E0000800D0000000F0000800E0000001000008014000000110000801C0000001200008024000000130000802D0000001400008036000000150000803F000000160000804800000017000085FA0000001D000080FB0000001E000080050100001F0000800500060009001C000900180009000A000D0048000D0037000D0039000D003C000D0037000D0038000D0038000D00430009000A000900260005000600F2000000A8000000080100000100010096000000000000000C0000009C0000000000000022000080010000002300008007000000240000800D000000250000800E0000002600008014000000270000801C0000002800008024000000290000802D0000002A000082880000002D000080890000002E000080930000002F0000800500060009001C000900180009000A000D0048000D0037000D0039000D003C000D00350009000A000900260005000600F2000000480000009E010000010001001800000000000000040000003C000000000000003300008001000000340000800700000036000080160000003700008005000600090034000900230005000600F400000008000000010000000000000018000000000000002000000038000000540000006C00000088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF1A092FF1300000001C020000550000000100000089000000010000002100000001000000390000000100000001000000010000006D00000001000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000008000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C0000001800000024000000300000003C0000008002000001003036303030303032000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E00251100000000040000000100546F5065727369616E4461746554696D65001600291100000000040000000100303630303030303100001A00251100000000800200000100546F5065727369616E44617465001600291100000000800200000100303630303030303200001A0025110000000018040000010049734C65617059656172000000001600291100000000180400000100303630303030303300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000FFFFFFFF1A092FF100000000000000000100303630303030303100001A00251100000000800200000100546F5065727369616E44617465001600291100000000800200000100303630303030303200001A0025110000000018040000010049734C6561705965617200000000160029110000000018040000010030363030303030330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000900000084000000BC00000038000000FFFFFFFF38000000000000008C0000008000000058000000080000000300000006000000070000000A000000090000000400000072632F66696C65732F643A5C7065727369616E63616C656E6461725C7065727369616E63616C656E6461725C617373656D626C79696E666F2E6373000400000006000000010000003A0000000000000011000000070000000A000000060000000000000005000000220000000800000000000000419132010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001400000020000000BC000000380000007701000038000000000000008C000000800000005800000028000000C0050000440200002C0000006C00000003000000140000000600000013000000070000000A0000000B00000008000000090000000C0000000D0000000E0000000F00000010000000120000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF77093101030000000A00008C0B0046510C00A08260000000580000002C00000040000000000000000000000016000000190000000000EEC00000000000000000FFFF000000000000FFFFFFFF00000000FFFF0000000000000000000000000900D404000000000000E401000001000000E07FAC00000000000000000055736572446566696E656446756E6374696F6E730037314141414545380000002DBA2EF10100000000000000080100000000000000000000000000000000000001000000080100009600000000000000000000000000000000000000010000009E0100001800000000000000000000000000000000000000020002000D01000000000100FFFFFFFF00000000B60100000802000000000000FFFFFFFF00000000FFFFFFFF010001000000010000000000643A5C5065727369616E43616C656E6461725C5065727369616E43616C656E6461725C417373656D626C79496E666F2E63730000FEEFFEEF010000000100000000010000000000000000000000FFFFFFFFFFFFFFFFFFFF0F00FFFFFFFFFFFFFFFFFFFF00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000942E3101B4EF7F56030000006DED9571E3F2704FBFCBCD9687E925AE600000002F4C696E6B496E666F002F6E616D6573002F7372632F686561646572626C6F636B002F7372632F66696C65732F643A5C7065727369616E63616C656E6461725C7065727369616E63616C656E6461725C617373656D626C79696E666F2E6373000400000006000000010000003A0000000000000011000000070000000A000000060000000000000005000000220000000800000000000000419132010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000044000000BC000000380000009301000038000000000000008C0000008000000058000000D40600005C0200002C000000A0000000FFFFFFFFFFFFFFFF2800000014000000170000000600000016000000070000000A0000000B000000050000000C0000000D0000000E0000000F00000010000000110000001300000012000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
AS N'PersianCalendar.pdb'

GO

/*

DROP FUNCTION ToPersianDate
DROP FUNCTION ToPersianDateTime
DROP FUNCTION IsLeapYear
DROP FUNCTION DATEADDPersian
DROP FUNCTION DATEDIFFPersian
DROP FUNCTION ISDATEPersian


DROP ASSEMBLY PersianCalendar
*/


SELECT [dbo].[ToPersianDateTime] (GETDATE()), [dbo].[ToPersianDate] (GETDATE()),
[dbo].[IsLeapYear] (1370),
[dbo].[DATEADDPersian] ('DAY', -29, '1371/07/29'),
[dbo].[DATEADDPersian] ('YEAR', -1, '1371/12/29'),
[dbo].[DATEDIFFPersian] ('DAY','1371/08/29', '1371/08/30'),
[dbo].[ISDATEPersian] (null) AS ISDATEPersian

SELECT DATEADD(year,5, '2006-07-31');
